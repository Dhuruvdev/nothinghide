{% extends "base.html" %}

{% block title %}Username Results - {{ result.username if result else 'Error' }} - NothingHide{% endblock %}

{% block content %}
<div class="container">
    <div class="logo">
        <a href="/"><img src="{{ url_for('static', path='/logo-title.png') }}" alt="NothingHide" class="logo-img"></a>
    </div>
    <p class="tagline">Username OSINT Results</p>
    
    {% if error %}
    <div class="error-box">
        {{ error }}
    </div>
    {% elif result %}
    
    <div class="result-box" style="border: 2px solid #000; padding: 0; overflow: hidden; background: #fff; box-shadow: 4px 4px 0 #000; margin-bottom: 30px;">
        <div style="background: #000; color: #fff; padding: 10px 15px; font-weight: bold; text-transform: uppercase; font-size: 12px; display: flex; justify-content: space-between;">
            <span>Intelligence Chain Graph</span>
            <span>OSINT v2026.1</span>
        </div>
        <div style="padding: 20px; display: flex; flex-direction: column; gap: 20px; font-family: 'Space Mono', monospace;">
            <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px dashed #ccc; padding-bottom: 15px;">
                <div style="text-align: center; flex: 1;">
                    <div style="font-size: 10px; color: #666;">COLLECTION</div>
                    <div style="font-size: 20px; font-weight: bold;">{{ result.total_platforms_checked }}</div>
                    <div style="font-size: 9px;">SOURCES</div>
                </div>
                <div style="font-size: 20px;">➔</div>
                <div style="text-align: center; flex: 1;">
                    <div style="font-size: 10px; color: #666;">ANALYSIS</div>
                    <div style="font-size: 20px; font-weight: bold;">{{ result.accounts_found }}</div>
                    <div style="font-size: 9px;">HITS</div>
                </div>
                <div style="font-size: 20px;">➔</div>
                <div style="text-align: center; flex: 1;">
                    <div style="font-size: 10px; color: #666;">EXTRACTION</div>
                    <div style="font-size: 20px; font-weight: bold;">{{ result.identity_risk.level }}</div>
                    <div style="font-size: 9px;">RISK</div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div style="border: 1px solid #000; padding: 10px;">
                    <div style="font-size: 10px; font-weight: bold; border-bottom: 1px solid #000; margin-bottom: 8px;">BEHAVIORAL SIGNALS</div>
                    {% for cat, count in result.categories.items() %}
                    <div style="display: flex; justify-content: space-between; font-size: 10px; margin-bottom: 3px;">
                        <span>{{ cat.upper() }}</span>
                        <span>{{ count }}</span>
                    </div>
                    {% endfor %}
                </div>
                <div style="border: 1px solid #000; padding: 10px;">
                    <div style="font-size: 10px; font-weight: bold; border-bottom: 1px solid #000; margin-bottom: 8px;">PII LEAKAGE</div>
                    {% if result.identity_risk.factors %}
                        {% for factor in result.identity_risk.factors[:4] %}
                        <div style="font-size: 9px; margin-bottom: 3px; color: #cc0000;">• {{ factor.upper() }}</div>
                        {% endfor %}
                    {% else %}
                        <div style="font-size: 9px; color: #666;">NO SIGNIFICANT LEAKS</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="result-box">
        <h2>Scan Summary: {{ result.username }}</h2>
        
        <table class="stats-table">
            <tr>
                <td>Username Analyzed</td>
                <td><strong>{{ result.username }}</strong></td>
            </tr>
            <tr>
                <td>Platforms Scanned</td>
                <td>{{ result.total_platforms_checked }}</td>
            </tr>
            <tr>
                <td>Accounts Found</td>
                <td>
                    {% if result.accounts_found > 10 %}
                    <span class="status-exposed">{{ result.accounts_found }} accounts</span>
                    {% elif result.accounts_found > 5 %}
                    <span class="status-warning">{{ result.accounts_found }} accounts</span>
                    {% else %}
                    <span class="status-clear">{{ result.accounts_found }} accounts</span>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>Timestamp</td>
                <td>{{ result.timestamp }}</td>
            </tr>
        </table>
    </div>
    
    {% if result.identity_risk %}
    <div class="result-box" style="{% if result.identity_risk.level == 'CRITICAL' %}border-color: #cc0000; background-color: #fff0f0;{% elif result.identity_risk.level == 'HIGH' %}border-color: #cc6600; background-color: #fff8f0;{% elif result.identity_risk.level == 'MODERATE' %}border-color: #cccc00; background-color: #fffff0;{% else %}border-color: #008800; background-color: #f0fff0;{% endif %}">
        <h2>Identity Risk Assessment</h2>
        
        <table class="stats-table">
            <tr>
                <td>Risk Level</td>
                <td>
                    {% if result.identity_risk.level == 'CRITICAL' %}
                    <span class="status-exposed">CRITICAL</span>
                    {% elif result.identity_risk.level == 'HIGH' %}
                    <span class="status-exposed">HIGH</span>
                    {% elif result.identity_risk.level == 'MODERATE' %}
                    <span class="status-warning">MODERATE</span>
                    {% else %}
                    <span class="status-clear">LOW</span>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>Risk Score</td>
                <td>
                    <strong>{{ result.identity_risk.score }}/100</strong>
                    <div style="background: #ddd; height: 8px; border-radius: 4px; margin-top: 4px;">
                        <div style="background: {% if result.identity_risk.score >= 70 %}#cc0000{% elif result.identity_risk.score >= 50 %}#cc6600{% elif result.identity_risk.score >= 30 %}#cccc00{% else %}#008800{% endif %}; height: 8px; border-radius: 4px; width: {{ result.identity_risk.score }}%;"></div>
                    </div>
                </td>
            </tr>
        </table>
        
        {% if result.identity_risk.factors %}
        <h3 style="font-size: 13px; margin-top: 15px; color: #666;">Risk Factors Detected:</h3>
        <ul style="font-size: 12px; margin: 8px 0; padding-left: 20px;">
            {% for factor in result.identity_risk.factors %}
            <li style="margin: 4px 0;">{{ factor }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>
    {% endif %}
    
    {% if result.username_analysis and result.username_analysis.weaknesses %}
    <div class="result-box" style="border-color: #cc6600; background-color: #fff8f0;">
        <h2>Username Weaknesses</h2>
        <ul style="font-size: 12px; margin: 8px 0; padding-left: 20px;">
            {% for weakness in result.username_analysis.weaknesses %}
            <li style="margin: 4px 0; color: #cc6600;"><strong>Warning:</strong> {{ weakness }}</li>
            {% endfor %}
        </ul>
        
        <table class="stats-table" style="margin-top: 10px;">
            <tr>
                <td>Username Length</td>
                <td>{{ result.username_analysis.length }} characters</td>
            </tr>
            <tr>
                <td>Entropy Score</td>
                <td>{{ result.username_analysis.entropy_score }}% (higher = more unique)</td>
            </tr>
        </table>
    </div>
    {% endif %}
    
    {% if result.categories %}
    <div class="result-box">
        <h2>Platform Categories</h2>
        <table class="stats-table">
            {% for category, count in result.categories.items() %}
            <tr>
                <td>{{ category }}</td>
                <td>
                    {% if category == 'Financial' %}
                    <span class="status-exposed">{{ count }} account(s)</span>
                    {% elif category in ['Professional', 'Security'] %}
                    <span class="status-warning">{{ count }} account(s)</span>
                    {% else %}
                    {{ count }} account(s)
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}
    
    {% if result.identity_risk and result.identity_risk.recommendations %}
    <div class="recommendations">
        <h3>Security Recommendations</h3>
        <ul style="font-size: 12px; padding-left: 20px;">
            {% for rec in result.identity_risk.recommendations %}
            <li style="margin: 6px 0;">{{ rec }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    {% if result.platforms %}
    <div class="result-box">
        <h2>Accounts Found ({{ result.accounts_found }})</h2>
        <ul class="breach-list">
            {% for platform in result.platforms if platform.exists %}
            <li>
                <span class="breach-name">{{ platform.platform }}</span>
                <span class="breach-date" style="float: right; background: {% if platform.category == 'Financial' %}#ffcccc{% elif platform.category == 'Professional' %}#ffeecc{% elif platform.category == 'Development' %}#cce5ff{% else %}#e8e8e8{% endif %}; padding: 2px 8px; border-radius: 3px;">{{ platform.category }}</span>
                <br>
                <a href="{{ platform.url }}" target="_blank" rel="noopener noreferrer" style="font-size: 11px; color: #0066cc; word-break: break-all;">{{ platform.url }}</a>
                {% if platform.response_time %}
                <span style="font-size: 10px; color: #999; margin-left: 10px;">{{ platform.response_time }}s</span>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>
    
    <details style="margin: 20px 0; text-align: left;">
        <summary style="cursor: pointer; font-size: 13px; color: #666;">Show All Checked Platforms ({{ result.total_platforms_checked }})</summary>
        <div class="result-box" style="margin-top: 10px;">
            <table class="stats-table" style="font-size: 11px;">
                {% for platform in result.platforms %}
                <tr>
                    <td style="width: 30%;">{{ platform.platform }}</td>
                    <td>
                        {% if platform.exists %}
                        <span class="status-exposed">Found</span>
                        {% elif platform.error %}
                        <span style="color: #999;">Error: {{ platform.error }}</span>
                        {% else %}
                        <span class="status-clear">Not Found</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </details>
    {% endif %}
    
    {% endif %}
    
    <div style="margin-top: 20px;">
        <a href="/username" class="btn-pixel">Check Another Username</a>
    </div>
    
    <a href="/" class="btn-pixel">Back to Home</a>
</div>
{% endblock %}
