{% extends "base.html" %}

{% block title %}Password Check Results - NothingHide{% endblock %}

{% block content %}
<div class="container">
    <div class="logo">
        <img src="{{ url_for('static', path='/logo.png') }}" alt="NothingHide">
    </div>
    
    <h2>Password Check Results</h2>
    
    {% if error %}
    <div class="error-box">
        {{ error }}
    </div>
    {% elif result %}
    <div class="result-box">
        <h2>Threat Intelligence Report</h2>
        
        <table class="stats-table">
            <tr>
                <td>Exposure Status</td>
                <td>
                    {% if result.exposed %}
                    <span class="status-exposed">COMPROMISED</span>
                    {% else %}
                    <span class="status-clear">CLEAR</span>
                    {% endif %}
                </td>
            </tr>
            {% if result.exposed %}
            <tr>
                <td>Exposure Count</td>
                <td>{{ "{:,}".format(result.count) }} times in breach data</td>
            </tr>
            {% endif %}
            <tr>
                <td>Strength</td>
                <td>
                    {% if result.strength == 'COMPROMISED' %}
                    <span class="status-exposed">{{ result.strength }}</span>
                    {% elif result.strength == 'WEAK' %}
                    <span class="status-warning">{{ result.strength }}</span>
                    {% elif result.strength == 'STRONG' %}
                    <span class="status-clear">{{ result.strength }}</span>
                    {% else %}
                    {{ result.strength }}
                    {% endif %}
                    (Score: {{ result.strength_score }}/9)
                </td>
            </tr>
            <tr>
                <td>Hash Prefix</td>
                <td>{{ result.hash_prefix }}***** (only this was sent)</td>
            </tr>
            <tr>
                <td>Timestamp</td>
                <td>{{ result.timestamp }}</td>
            </tr>
        </table>
        
        <h3>Strength Analysis</h3>
        <table class="stats-table">
            <tr>
                <td>Length</td>
                <td>{{ result.length }} characters</td>
            </tr>
            <tr>
                <td>Uppercase</td>
                <td>{% if result.has_upper %}Yes{% else %}No{% endif %}</td>
            </tr>
            <tr>
                <td>Lowercase</td>
                <td>{% if result.has_lower %}Yes{% else %}No{% endif %}</td>
            </tr>
            <tr>
                <td>Numbers</td>
                <td>{% if result.has_digit %}Yes{% else %}No{% endif %}</td>
            </tr>
            <tr>
                <td>Special Characters</td>
                <td>{% if result.has_special %}Yes{% else %}No{% endif %}</td>
            </tr>
        </table>
        
        {% if result.exposed %}
        <div class="recommendations">
            <h3>Recommended Actions</h3>
            <ul>
                <li>STOP using this password immediately</li>
                <li>Change on ALL accounts where it's used</li>
                <li>Use a password manager to generate unique passwords</li>
                <li>Enable 2FA on all important accounts</li>
            </ul>
        </div>
        {% else %}
        <div class="privacy-notice">
            Password not found in breach databases.
            This does not guarantee security - always use strong, unique passwords.
        </div>
        {% endif %}
    </div>
    {% endif %}
    
    <a href="/password" class="back-link">&laquo; Check Another Password</a>
    <br>
    <a href="/" class="back-link">&laquo; Back to Home</a>
</div>
{% endblock %}
