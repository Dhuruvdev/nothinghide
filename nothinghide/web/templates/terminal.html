{% extends "base.html" %}

{% block title %}NothingHide Terminal - Breach Intelligence{% endblock %}

{% block content %}
<style>
body, html {
    margin: 0;
    padding: 0;
    background: #0a0a0a;
    min-height: 100vh;
}
.container { display: none; }
.footer { display: none; }

.terminal-wrapper {
    background: #0a0a0a;
    min-height: 100vh;
    font-family: 'Courier New', 'Monaco', 'Consolas', monospace;
    color: #00ff00;
    padding: 20px;
    box-sizing: border-box;
}

.terminal-header {
    text-align: center;
    margin-bottom: 30px;
    padding: 20px 0;
}

.ascii-logo {
    font-size: 10px;
    line-height: 1.1;
    color: #00ff00;
    white-space: pre;
    display: inline-block;
    text-shadow: 0 0 10px #00ff00;
}

.terminal-tagline {
    color: #888888;
    font-size: 12px;
    margin-top: 15px;
    letter-spacing: 2px;
}

.terminal-info {
    color: #666666;
    font-size: 11px;
    margin-top: 8px;
}

.terminal-body {
    max-width: 700px;
    margin: 0 auto;
}

.terminal-prompt {
    display: flex;
    align-items: center;
    margin: 20px 0;
}

.prompt-symbol {
    color: #00ff00;
    margin-right: 10px;
    font-weight: bold;
}

.terminal-input {
    flex: 1;
    background: transparent;
    border: none;
    color: #00ff00;
    font-family: inherit;
    font-size: 14px;
    outline: none;
    caret-color: #00ff00;
}

.terminal-input::placeholder {
    color: #444444;
}

.terminal-btn {
    background: transparent;
    border: 1px solid #00ff00;
    color: #00ff00;
    padding: 8px 20px;
    font-family: inherit;
    font-size: 12px;
    cursor: pointer;
    margin-left: 10px;
    transition: all 0.2s;
}

.terminal-btn:hover {
    background: #00ff00;
    color: #0a0a0a;
}

.terminal-output {
    border: 1px solid #333333;
    background: #050505;
    padding: 15px;
    margin: 20px 0;
    min-height: 200px;
    max-height: 400px;
    overflow-y: auto;
}

.output-line {
    margin: 5px 0;
    font-size: 13px;
    line-height: 1.5;
}

.output-line.info { color: #00ff00; }
.output-line.warning { color: #ffff00; }
.output-line.error { color: #ff4444; }
.output-line.success { color: #44ff44; }
.output-line.dim { color: #666666; }

.loading-bar {
    display: none;
    margin: 15px 0;
}

.loading-bar.active { display: block; }

.progress-container {
    background: #222222;
    height: 4px;
    width: 100%;
    margin: 10px 0;
}

.progress-bar {
    background: #00ff00;
    height: 100%;
    width: 0%;
    transition: width 0.3s;
    box-shadow: 0 0 10px #00ff00;
}

.loading-text {
    color: #888888;
    font-size: 11px;
}

.spinner {
    display: inline-block;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { content: '|'; }
    25% { content: '/'; }
    50% { content: '-'; }
    75% { content: '\\'; }
}

.cursor-blink {
    animation: blink 1s step-end infinite;
}

@keyframes blink {
    50% { opacity: 0; }
}

.menu-section {
    margin: 30px 0;
    border: 1px solid #333333;
    padding: 15px;
}

.menu-title {
    color: #00ff00;
    font-size: 12px;
    margin-bottom: 15px;
    border-bottom: 1px solid #333333;
    padding-bottom: 8px;
}

.menu-item {
    display: block;
    color: #888888;
    text-decoration: none;
    padding: 8px 0;
    font-size: 13px;
    transition: color 0.2s;
}

.menu-item:hover {
    color: #00ff00;
}

.menu-item .key {
    color: #00ff00;
    margin-right: 10px;
}

.stats-bar {
    display: flex;
    justify-content: space-between;
    border-top: 1px solid #333333;
    padding-top: 15px;
    margin-top: 30px;
    font-size: 11px;
    color: #666666;
}

.stat-item {
    text-align: center;
}

.stat-value {
    color: #00ff00;
    font-size: 14px;
    margin-bottom: 3px;
}

@media (max-width: 768px) {
    .ascii-logo { font-size: 6px; }
    .terminal-wrapper { padding: 10px; }
    .terminal-prompt { flex-direction: column; align-items: stretch; }
    .terminal-btn { margin: 10px 0 0 0; }
    .stats-bar { flex-wrap: wrap; gap: 15px; }
}
</style>

<div class="terminal-wrapper">
    <div class="terminal-header">
        <pre class="ascii-logo">
 ███╗   ██╗ ██████╗ ████████╗██╗  ██╗██╗███╗   ██╗ ██████╗ ██╗  ██╗██╗██████╗ ███████╗
 ████╗  ██║██╔═══██╗╚══██╔══╝██║  ██║██║████╗  ██║██╔════╝ ██║  ██║██║██╔══██╗██╔════╝
 ██╔██╗ ██║██║   ██║   ██║   ███████║██║██╔██╗ ██║██║  ███╗███████║██║██║  ██║█████╗  
 ██║╚██╗██║██║   ██║   ██║   ██╔══██║██║██║╚██╗██║██║   ██║██╔══██║██║██║  ██║██╔══╝  
 ██║ ╚████║╚██████╔╝   ██║   ██║  ██║██║██║ ╚████║╚██████╔╝██║  ██║██║██████╔╝███████╗
 ╚═╝  ╚═══╝ ╚═════╝    ╚═╝   ╚═╝  ╚═╝╚═╝╚═╝  ╚═══╝ ╚═════╝ ╚═╝  ╚═╝╚═╝╚═════╝ ╚══════╝
        </pre>
        <div class="terminal-tagline">[ LIGHTWEIGHT CLIENT-SIDE INTERFACE ]</div>
        <div class="terminal-info">v1.0.0 | Client-Side Rendering | Low Bandwidth | Zero Server Load</div>
    </div>

    <div class="terminal-body">
        <form id="scan-form">
            <div class="terminal-prompt">
                <span class="prompt-symbol">$</span>
                <input type="text" class="terminal-input" id="query-input" placeholder="enter email, password, or username to scan..." autocomplete="off">
                <button type="submit" class="terminal-btn">[SCAN]</button>
            </div>
        </form>

        <div class="loading-bar" id="loading-bar">
            <div class="loading-text" id="loading-text">Initializing scan...</div>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </div>

        <div class="terminal-output" id="output">
            <div class="output-line dim">> System initialized</div>
            <div class="output-line dim">> Connected to breach databases</div>
            <div class="output-line info">> Ready for input<span class="cursor-blink">_</span></div>
        </div>

        <div class="menu-section">
            <div class="menu-title">[ AVAILABLE COMMANDS ]</div>
            <a href="/email" class="menu-item"><span class="key">[1]</span> EMAIL CHECK - Scan breach databases for email exposure</a>
            <a href="/password" class="menu-item"><span class="key">[2]</span> PASSWORD CHECK - K-anonymity breach lookup</a>
            <a href="/username" class="menu-item"><span class="key">[3]</span> USERNAME OSINT - Platform reconnaissance (60+ sites)</a>
            <a href="/fullscan" class="menu-item"><span class="key">[4]</span> FULL SCAN - Complete identity analysis</a>
            <a href="/help" class="menu-item"><span class="key">[H]</span> HELP - Documentation and data sources</a>
            <a href="/" class="menu-item"><span class="key">[Q]</span> EXIT - Return to standard interface</a>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value">6+</div>
                <div>DATABASES</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">60+</div>
                <div>PLATFORMS</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">7B+</div>
                <div>RECORDS</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">K-ANON</div>
                <div>PROTOCOL</div>
            </div>
        </div>
    </div>
</div>

<script>
const output = document.getElementById('output');
const loadingBar = document.getElementById('loading-bar');
const progressBar = document.getElementById('progress-bar');
const loadingText = document.getElementById('loading-text');
const form = document.getElementById('scan-form');
const input = document.getElementById('query-input');

const loadingMessages = [
    "Initializing scan protocols...",
    "Connecting to breach databases...",
    "Querying LeakCheck API...",
    "Scanning HaveIBeenPwned...",
    "Analyzing XposedOrNot...",
    "Cross-referencing records...",
    "Compiling threat report..."
];

function addLine(text, type = 'info') {
    const line = document.createElement('div');
    line.className = `output-line ${type}`;
    line.innerHTML = `> ${text}`;
    output.appendChild(line);
    output.scrollTop = output.scrollHeight;
}

function clearOutput() {
    output.innerHTML = '';
}

function detectQueryType(query) {
    if (query.includes('@')) return 'email';
    if (query.length < 20 && /^[a-zA-Z0-9._-]+$/.test(query)) return 'username';
    return 'password';
}

async function runScan(query) {
    clearOutput();
    loadingBar.classList.add('active');
    progressBar.style.width = '0%';
    
    const queryType = detectQueryType(query);
    addLine(`Detected query type: ${queryType.toUpperCase()}`, 'dim');
    addLine(`Target: ${queryType === 'password' ? '********' : query}`, 'dim');
    addLine('', 'dim');
    
    for (let i = 0; i < loadingMessages.length; i++) {
        loadingText.textContent = loadingMessages[i];
        progressBar.style.width = `${((i + 1) / loadingMessages.length) * 100}%`;
        addLine(loadingMessages[i], 'dim');
        await new Promise(r => setTimeout(r, 400 + Math.random() * 300));
    }
    
    loadingBar.classList.remove('active');
    addLine('', 'dim');
    addLine('Scan complete. Redirecting to results...', 'success');
    
    await new Promise(r => setTimeout(r, 500));
    
    if (queryType === 'email') {
        window.location.href = `/email?prefill=${encodeURIComponent(query)}`;
    } else if (queryType === 'username') {
        window.location.href = `/username?prefill=${encodeURIComponent(query)}`;
    } else {
        window.location.href = `/password`;
    }
}

form.addEventListener('submit', (e) => {
    e.preventDefault();
    const query = input.value.trim();
    if (query) {
        runScan(query);
    }
});

document.addEventListener('keydown', (e) => {
    if (e.key === '1') window.location.href = '/email';
    if (e.key === '2') window.location.href = '/password';
    if (e.key === '3') window.location.href = '/username';
    if (e.key === '4') window.location.href = '/fullscan';
    if (e.key.toLowerCase() === 'h') window.location.href = '/help';
    if (e.key.toLowerCase() === 'q') window.location.href = '/';
});

addLine('Type query or press number key for quick access', 'dim');
</script>
{% endblock %}
