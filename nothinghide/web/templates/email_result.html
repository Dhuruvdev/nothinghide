{% extends "base.html" %}

{% block title %}Email Check Results - NothingHide{% endblock %}

{% block content %}
<div class="container">
    <div class="logo">
        <h1 class="logo-text">NOTHINGHIDE</h1>
    </div>
    
    <p class="tagline">Email Breach Check Results</p>
    
    {% if error %}
    <div class="error-box">
        {{ error }}
    </div>
    {% elif result %}
    <div class="result-box">
        <h2>Threat Intelligence Report</h2>
        
        <table class="stats-table">
            <tr>
                <td>Email</td>
                <td>{{ result.email }}</td>
            </tr>
            <tr>
                <td>Exposure Status</td>
                <td>
                    {% if result.breached %}
                    <span class="status-exposed">COMPROMISED</span>
                    {% else %}
                    <span class="status-clear">CLEAR</span>
                    {% endif %}
                </td>
            </tr>
            {% if result.breached %}
            <tr>
                <td>Breaches Found</td>
                <td>{{ result.breach_count }}</td>
            </tr>
            <tr>
                <td>Risk Score</td>
                <td>{{ result.risk_score }}/100</td>
            </tr>
            {% endif %}
            <tr>
                <td>Sources Checked</td>
                <td>{{ result.sources_succeeded|join(', ') or 'Multiple sources' }}</td>
            </tr>
            <tr>
                <td>Timestamp</td>
                <td>{{ result.timestamp }}</td>
            </tr>
        </table>
        
        {% if result.breached and result.breaches %}
        <h3>Breach Details</h3>
        <ul class="breach-list">
            {% for breach in result.breaches %}
            <li>
                <span class="breach-name">{{ breach.name or 'Unknown' }}</span>
                <span class="breach-date"> - {{ breach.date or breach.year or 'Unknown date' }}</span>
                {% if breach.data_classes %}
                <div class="breach-data">Exposed: {{ breach.data_classes|join(', ') }}</div>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
        {% endif %}
        
        {% if result.breached %}
        <div class="recommendations">
            <h3>Recommended Actions</h3>
            <ul>
                <li>Change all passwords associated with this email</li>
                <li>Enable two-factor authentication (2FA)</li>
                <li>Use a password manager for unique passwords</li>
                <li>Monitor accounts for suspicious activity</li>
            </ul>
        </div>
        {% else %}
        <div class="privacy-notice">
            No breach records found in queried databases. Continue practicing good security hygiene.
        </div>
        {% endif %}
    </div>
    {% endif %}
    
    <a href="/email" class="back-link">&laquo; Check Another Email</a>
    <br>
    <a href="/" class="back-link">&laquo; Back to Home</a>
</div>
{% endblock %}
