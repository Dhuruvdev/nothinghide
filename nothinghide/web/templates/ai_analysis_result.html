{% extends "base.html" %}

{% block title %}Analysis Result - NothingHide{% endblock %}
{% block description %}AI analysis results for deepfake and AI-generated content detection.{% endblock %}

{% block content %}
<div class="container">
    <div class="logo">
        <a href="/"><img src="{{ url_for('static', path='/logo-title.png') }}" alt="NothingHide" class="logo-img"></a>
    </div>
    
    {% if error %}
    <div class="error-box">
        <p>{{ error }}</p>
    </div>
    {% else %}
    
    <div class="result-box">
        <h2>Multi-Agent Analysis Complete</h2>
        
        <div style="text-align: center; padding: 15px; margin: 10px 0; 
            {% if result.is_authentic %}
            background-color: #e8f5e9; border: 2px solid #4caf50;
            {% else %}
            background-color: #ffebee; border: 2px solid #f44336;
            {% endif %}
        ">
            <div style="font-size: 24px; font-weight: bold; 
                {% if result.is_authentic %}color: #2e7d32;{% else %}color: #c62828;{% endif %}
            ">
                {% if result.is_authentic %}AUTHENTIC{% else %}SUSPICIOUS{% endif %}
            </div>
            <div style="font-size: 12px; color: #666; margin-top: 5px;">
                Threat Level: <strong style="text-transform: uppercase;">{{ result.threat_level }}</strong>
            </div>
        </div>
        
        <table class="stats-table">
            <tr>
                <td>Overall Verdict</td>
                <td>{{ result.overall_verdict }}</td>
            </tr>
            <tr>
                <td>Confidence Score</td>
                <td>{{ result.confidence_score }}%</td>
            </tr>
            <tr>
                <td>Agents Used</td>
                <td>{{ result.agent_results|length }} AI Models</td>
            </tr>
            <tr>
                <td>Processing Time</td>
                <td>{{ result.total_processing_time }}s</td>
            </tr>
            <tr>
                <td>Timestamp</td>
                <td>{{ result.timestamp }}</td>
            </tr>
        </table>
    </div>
    
    <div class="result-box">
        <h2>Agent-by-Agent Results</h2>
        
        {% for agent in result.agent_results %}
        <div style="border: 1px solid #ddd; padding: 10px; margin: 8px 0; background: #fafafa;">
            <div style="font-weight: bold; font-size: 13px; color: #333;">
                {{ agent.agent_name }}
            </div>
            
            {% if agent.status == 'complete' %}
            <div style="margin: 8px 0;">
                <span style="
                    padding: 3px 8px; 
                    font-size: 11px; 
                    font-weight: bold;
                    {% if 'AUTHENTIC' in agent.prediction or 'HUMAN' in agent.prediction or 'SAFE' in agent.prediction %}
                    background: #c8e6c9; color: #2e7d32;
                    {% else %}
                    background: #ffcdd2; color: #c62828;
                    {% endif %}
                ">
                    {{ agent.prediction }}
                </span>
                <span style="font-size: 11px; color: #666; margin-left: 10px;">
                    {{ agent.confidence }}% confidence
                </span>
            </div>
            
            {% if agent.details.all_scores %}
            <div style="font-size: 10px; color: #888; margin-top: 5px;">
                Scores: 
                {% for label, score in agent.details.all_scores.items() %}
                {{ label }}: {{ score }}%{% if not loop.last %}, {% endif %}
                {% endfor %}
            </div>
            {% endif %}
            
            {% elif agent.status == 'error' %}
            <div style="color: #cc0000; font-size: 11px; margin-top: 5px;">
                Error: {{ agent.error }}
            </div>
            {% endif %}
            
            <div style="font-size: 10px; color: #999; margin-top: 5px;">
                Processing time: {{ agent.processing_time }}s
            </div>
        </div>
        {% endfor %}
    </div>
    
    {% if result.recommendations %}
    <div class="recommendations">
        <h3>Recommendations</h3>
        <ul>
            {% for rec in result.recommendations %}
            <li>{{ rec }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    <div class="result-box">
        <h2>Analysis Summary</h2>
        <p style="font-size: 12px; line-height: 1.6;">{{ result.analysis_summary }}</p>
    </div>
    
    {% endif %}
    
    <div class="buttons" style="margin-top: 20px;">
        <a href="/ai-analysis" class="btn">Analyze Another Image</a>
        <a href="/" class="btn">Back to Home</a>
    </div>
</div>
{% endblock %}
